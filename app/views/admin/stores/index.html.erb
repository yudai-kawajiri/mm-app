<%= content_for(:title, t('admin.stores.index.title')) %>

<div data-controller="resource-search">
  <%= render 'shared/layouts/header_with_actions',
    title: t('admin.stores.index.title'),
    resource: nil,
    is_index_page: true,
    is_form_page: false,
    is_show_page: false,
    new_path: (current_user.store_admin? ? nil : new_admin_store_path),
    skip_store_check: true %>

  <% if @stores.any? %>
    <div class="table-responsive">
      <table class="table table-hover align-middle">
        <thead class="table-light">
          <tr>
            <th><%= t('admin.stores.index.table_headers.code') %></th>
            <th><%= t('admin.stores.index.table_headers.name') %></th>
            <th><%= t('admin.stores.index.table_headers.invitation_code') %></th>
            <th><%= t('admin.stores.index.table_headers.users_count') %></th>
            <th><%= t('admin.stores.index.table_headers.created_at') %></th>
            <th class="text-center"><%= t('admin.stores.index.table_headers.actions') %></th>
          </tr>
        </thead>
        <tbody>
          <% @stores.each do |store| %>
            <tr>
              <td><%= store.code %></td>
              <td><%= store.name %></td>
              <td><code><%= store.invitation_code %></code></td>
              <td><%= store.users_count %></td>
              <td><%= l(store.created_at, format: :long) %></td>
              <td class="text-center">
                <% if current_user.store_admin? %>
                  <%# 店舗管理者: 閲覧のみ %>
                  <%= link_to admin_store_path(store), class: "btn btn-sm btn-outline-primary", title: t('helpers.links.show') do %>
                    <i class="bi bi-eye"></i>
                  <% end %>
                <% else %>
                  <%# 会社管理者・システム管理者: 全アクション可能 %>
                  <%= render 'shared/actions/resource_action_links',
                      resource: store,
                      scope: :admin,
                      icon_mode: true,
                      show_link: true,
                      show_copy: false,
                      show_print: false %>
                <% end %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  <% else %>
    <div class="alert alert-info d-flex align-items-center" role="alert">
      <i class="bi bi-info-circle me-2"></i>
      <%= t('admin.stores.index.no_stores') %>
    </div>
  <% end %>
</div>
