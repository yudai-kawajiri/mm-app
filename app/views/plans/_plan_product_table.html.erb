<% plan_products = local_assigns[:plan_products] %>

<% if plan_products.present? %>
  <table class="table table-sm table-borderless">
    <thead>
      <tr class="border-bottom">
        <%# すべてのヘッダーを text-muted に統一 %>
        <th class="text-muted"><%= t('activerecord.attributes.plan_product.product_name', default: '商品名') %></th>
        <th class="text-end text-muted"><%= t('activerecord.attributes.plan_product.production_count', default: '数量') %></th>
        <th class="text-end text-muted"><%= t('activerecord.attributes.product.price', default: '売価') %></th>
        <th class="text-end text-muted"><%= t('views.common.subtotal', default: '小計') %></th>
      </tr>
    </thead>
    <tbody>
      <% (plan_products || []).each do |pp| %>
        <tr class="border-bottom">
          <%# 商品名 %>
          <td><%= pp.product&.name %></td>

          <%# 生産数 - 濃い文字（デフォルト） %>
          <td class="text-end"><%= pp.production_count %></td>

          <%# 売価 - 濃い文字（デフォルト） %>
          <td class="text-end"><%= number_to_currency(pp.product&.price, precision: 0) %></td>

          <%# 小計 - 濃い文字（デフォルト） %>
          <td class="text-end">
            <% subtotal = pp.production_count * (pp.product&.price || 0) %>
            <%= number_to_currency(subtotal, precision: 0) %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
<% else %>
  <p class="text-muted text-center" style="padding-top: 50px; font-size: 1.0em;">
    <%= t('plans.product_fields.no_products_set') %>
  </p>
<% end %>