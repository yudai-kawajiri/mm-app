<%# 1. 製品名 %>
<div class="mb-4">
  <%= f.label :name, class: "form-label h5" %>
  <%= f.text_field :name, class: "form-control form-control-lg" %>
</div>

<%# 2. 品目番号 %>
<div class="mb-4">
  <%= f.label :item_number, class: "form-label h5" %>
  <%= f.text_field :item_number, class: "form-control form-control-lg" %>
</div>

<%# 3. 売価 %>
<div class="mb-4">
  <%= f.label :price, class: "form-label h5" %>
  <div class="input-group input-group-lg">
    <span class="input-group-text"><%= t('number.currency.format.unit') %></span>
    <%= f.number_field :price, class: "form-control", step: 1, min: 0 %>

  </div>
</div>

<%# 4. カテゴリ %>
<div class="mb-4">
  <%= f.label :category_id, class: "form-label h5" %>
  <%= f.collection_select :category_id, current_user.categories,
                          :id,
                          :name,
                          { prompt: t('helpers.prompt.select') },
                          { class: "form-select form-select-lg" } %>
</div>

<%# 5. ステータス %>
<div class="mb-4">
  <%= f.label :status, class: "form-label h5" %>
  <%= f.select :status, Product.statuses.keys.map { |status| [t("activerecord.enums.product.status.#{status}"), status] },
      { prompt: t('helpers.prompt.select') },
      { class: "form-select form-select-lg" } %>
</div>

<%# 6. 説明 %>
<div class="mb-4">
  <%= f.label :description, class: "form-label h5" %>
  <%= f.text_area :description, rows: 5, class: "form-control form-control-lg" %>
</div>

  <%# [右カラム] 画像の表示・アップロード・削除機能 %>
    <div class="mb-3">
      <%= f.label :image, class: "form-label" %>

      <%# 既存の画像表示エリアとプレビュー %>
      <div class="text-center">
        <%# image_tagは一行記述で構文安定化済み %>
        <%= image_tag(f.object.image.attached? ? f.object.image : '', id: 'image-preview', style: "max-width: 200px; height: auto; #{f.object.image.attached? ? 'display: block;' : 'display: none;'}", class: "img-thumbnail mb-2", data: { existing_image: f.object.image.attached?.to_s }) %>
      </div>

      <%# ボタン表示 %>
      <div class="text-center mb-2 mt-1">
        <%# 1. 既存画像削除ボタン (初期表示: 既存画像がある場合のみ) %>
        <% if f.object.image.attached? %>
          <div id="current-image-container-<%= f.object.id %>">
            <%# link_toは一行記述で構文安定化済み %>
            <%= link_to t('helpers.link.delete_image'), "#", data: { product_id: f.object.id, url: purge_image_product_path(f.object) }, class: "btn btn-sm btn-danger", id: "delete-button-#{f.object.id}" %>
          </div>
        <% end %>

        <%# 2. 新規画像選択時のキャンセルボタン (初期表示: 非表示) %>
        <div id="new-image-action" style="display: none;">
          <button type="button" id="cancel-new-image-button" class="btn btn-sm btn-outline-danger">
            <%= t('helpers.link.cancel_new_image') %>
          </button>
        </div>
      </div>

      <div class="mt-3">
        <%= f.file_field :image, id: 'product-image-input', class: "form-control" %>
        <small class="text-muted">
          <%= f.object.image.attached? ? t('products.image_help.change') : t('products.image_help.select') %>
        </small>
      </div>
    </div>