<%# 原材料フォームフィールド %>
<div class="row">
  <div class="col-md-4">
    <%= form_group_lg(f, :name, required: true, label: raw([t('activerecord.attributes.resources/material.name'), t('helpers.required_mark')].join(' '))) %>
  </div>

  <div class="col-md-4">
    <%= form_group_lg(f, :reading, required: true, label: raw([t('activerecord.attributes.resources/material.reading'), t('helpers.required_mark')].join(' '))) %>
  </div>

  <div class="col-md-4">
    <%= form_group_lg(f, :category_id,
        field_type: :collection_select,
        collection: @material_categories,
        required: true,
        label: raw([t('activerecord.attributes.resources/material.category_id'), t('helpers.required_mark')].join(' ')),
        select_options: { include_blank: t('helpers.prompt.select') }
    ) %>
  </div>
</div>

<div class="row">
  <div class="col-md-6">
    <div class="form-group mb-4">
      <label class="form-label h5 text-muted mb-2">
        <%= raw([Resources::Material.human_attribute_name(:default_unit_weight), t('helpers.required_mark')].join(' ')) %>
        <small class="text-muted"><%= t('materials.form.default_unit_weight_help') %></small>
      </label>

      <%= f.text_field :default_unit_weight,
          class: 'form-control form-control-lg',
          required: true,
          data: {
            controller: 'input--number-input' ,
            'number-input-no-comma': 'true',
            'number-input-decimal-field': 'true',
            action: 'input->input--number-input#handleInput paste->input--number-input#handlePaste focus->input--number-input#handleFocus blur->input--number-input#handleBlur',
            'form-validation-target': 'field'
          }
      %>
    </div>
  </div>

  <div class="col-md-6">
    <div class="form-group mb-4">
      <label class="form-label h5 text-muted mb-2">
        <%= raw([Resources::Material.human_attribute_name(:unit_for_product), t('helpers.required_mark')].join(' ')) %>
        <small class="text-muted"><%= t('materials.form.unit_for_product_help') %></small>
      </label>

      <%= f.collection_select :unit_for_product_id,
          @production_units,
          :id,
          :name,
          { include_blank: t('helpers.prompt.select') },
          { class: 'form-select form-select-lg', required: true, data: { 'form-validation-target': 'field' } } %>
    </div>
  </div>
</div>

<div class="row" data-controller="resources--material-form">
  <div class="col-md-6">
    <div class="form-group mb-4">
      <div class="d-flex align-items-center gap-3 mb-2">
        <label class="form-label mb-0" style="font-size: 1.25rem; font-weight: 400;">
          <%= raw([t('materials.form.basic_order_quantity'), t('helpers.required_mark')].join(' ')) %>
        </label>
        <div class="form-check">
          <%= f.radio_button :measurement_type, 'weight',
              checked: f.object.measurement_type != 'count',
              class: 'form-check-input',
              data: { action: 'change->resources--material-form#toggleMeasurementFields' } %>
          <%= f.label :measurement_type_weight, t('materials.measurement_types.weight'), class: 'form-check-label' %>
        </div>
        <div class="form-check">
          <%= f.radio_button :measurement_type, 'count',
              class: 'form-check-input',
              data: { action: 'change->resources--material-form#toggleMeasurementFields' } %>
          <%= f.label :measurement_type_count, t('materials.measurement_types.count'), class: 'form-check-label' %>
        </div>
      </div>

      <%# 重量ベースのフィールド %>
      <div data-resources--material-form-target="weightField" style="<%= 'display: none;' if f.object.measurement_type == 'count' %>">
        <%= f.text_field :unit_weight_for_order,
          class: 'form-control form-control-lg',
          placeholder: t('materials.form.unit_weight_for_order_placeholder'),
          required: false,
          data: {
            controller: 'input--number-input',
            'number-input-no-comma': 'true',
            'number-input-decimal-field': 'true',
            action: 'input->input--number-input#handleInput paste->input--number-input#handlePaste focus->input--number-input#handleFocus blur->input--number-input#handleBlur',
            'form-validation-target': 'field'
          }
        %>
        <small class="text-muted"><%= t('materials.form.unit_weight_for_order_help') %></small>
      </div>

      <%# 個数ベースのフィールド %>
      <div data-resources--material-form-target="countField" style="<%= 'display: none;' unless f.object.measurement_type == 'count' %>">
        <%= f.text_field :pieces_per_order_unit,
          class: 'form-control form-control-lg',
          placeholder: t('materials.form.pieces_per_order_unit_placeholder'),
          required: false,
          data: {
            controller: 'input--number-input',
            'number-input-no-comma': 'true',
            'number-input-decimal-field': 'false',
            action: 'input->input--number-input#handleInput paste->input--number-input#handlePaste focus->input--number-input#handleFocus blur->input--number-input#handleBlur',
            'form-validation-target': 'field'
          }
        %>
        <small class="text-muted"><%= t('materials.form.pieces_per_order_unit_help') %></small>
      </div>
    </div>
  </div>

  <div class="col-md-6">
    <%= form_group_lg(f, :unit_for_order_id,
        field_type: :collection_select,
        collection: @order_units,
        required: true,
        label: raw([Resources::Material.human_attribute_name(:unit_for_order), t('helpers.required_mark')].join(' ')),
        select_options: { include_blank: t('helpers.prompt.select') }
    ) %>
  </div>
</div>

<div class="row">
  <div class="col-md-6">
    <div class="form-group mb-4">
      <label class="form-label h5 text-muted mb-2">
        <%= raw([Resources::Material.human_attribute_name(:production_unit), t('helpers.required_mark')].join(' ')) %>
        <small class="text-muted"><%= t('materials.form.production_unit_help') %></small>
      </label>

      <%= f.collection_select :production_unit_id,
          @manufacturing_units,
          :id,
          :name,
          { include_blank: t('helpers.prompt.select') },
          { class: 'form-select form-select-lg', required: true, data: { 'form-validation-target': 'field' } } %>
    </div>
  </div>
  <div class="col-md-6">
    <%= form_group_lg(f, :order_group_id,
        field_type: :collection_select,
        collection: @material_order_groups
    ) %>
  </div>
</div>

<div class="row">
  <div class="col-md-12">
    <%= form_group_lg(f, :description,
        field_type: :text_area,
        rows: 5,
        character_counter: true,
        max_length: Resources::Material::DESCRIPTION_MAX_LENGTH,
        help_text: t('helpers.character_counter.max_hint', max: Resources::Material::DESCRIPTION_MAX_LENGTH)
    ) %>
  </div>
</div>
