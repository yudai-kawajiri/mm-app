<%#
  機能: 原材料フォームフィールド
  - 原材料の全入力フィールド
  - 計測方法選択（重量/個数ベース）
  - 新規作成・編集画面で使用

  必須引数:
  - f: FormBuilder - フォームビルダーオブジェクト
%>
<div class="row">
  <div class="col-md-6">
    <%= form_group_lg(f, :name) %>
  </div>

  <div class="col-md-6">
    <%= form_group_lg(f, :category_id,
        field_type: :collection_select,
        collection: Resources::Category.where(category_type: :material).order(:name),
        select_options: { include_blank: t('helpers.prompt.select') }
    ) %>
  </div>
</div>

<div class="row">
  <div class="col-md-6">
    <div class="form-group mb-4">
      <label class="form-label h5 text-muted mb-2">
        <%= Resources::Material.human_attribute_name(:default_unit_weight) %>
        <small class="text-muted">商品1個あたりの使用量</small>
      </label>

      <%= f.text_field :default_unit_weight,
          class: 'form-control form-control-lg',
          data: {
            controller: 'number-input',
            'number-input-no-comma': 'true',
            'number-input-decimal-field': 'true',
            action: 'input->number-input#handleInput paste->number-input#handlePaste focus->number-input#handleFocus blur->number-input#handleBlur',
            'form-validation-target': 'field'
          }
      %>
    </div>
  </div>

  <div class="col-md-6">
    <div class="form-group mb-4">
      <label class="form-label h5 text-muted mb-2">
        <%= Resources::Material.human_attribute_name(:unit_for_product) %>
        <small class="text-muted">製造時の計量単位</small>
      </label>

      <%= f.collection_select :unit_for_product_id,
          current_user.units.where(category: :production),
          :id,
          :name,
          { include_blank: t('helpers.prompt.select') },
          { class: 'form-select form-select-lg' } %>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-md-6">
    <div class="form-group mb-4">
      <div class="d-flex align-items-center gap-3 mb-2">
        <label class="form-label mb-0" style="font-size: 1.25rem; font-weight: 400;">
          <%= Resources::Material.human_attribute_name(:unit_weight_for_order) %>
        </label>
        <div class="form-check">
          <%= f.radio_button :measurement_type, 'weight',
              checked: f.object.measurement_type != 'count',
              class: 'form-check-input' %>
          <%= f.label :measurement_type_weight, t('materials.measurement_types.weight'), class: 'form-check-label' %>
        </div>
        <div class="form-check">
          <%= f.radio_button :measurement_type, 'count',
              class: 'form-check-input' %>
          <%= f.label :measurement_type_count, t('materials.measurement_types.count'), class: 'form-check-label' %>
        </div>
      </div>

      <%= f.text_field :unit_weight_for_order,
        class: 'form-control form-control-lg',
        data: {
          controller: 'number-input',
          'number-input-no-comma': 'true',
          'number-input-decimal-field': 'true',
          action: 'input->number-input#handleInput paste->number-input#handlePaste focus->number-input#handleFocus blur->number-input#handleBlur'
        }
      %>
    </div>
  </div>

  <div class="col-md-6">
    <%= form_group_lg(f, :unit_for_order_id,
        field_type: :collection_select,
        collection: current_user.units.where(category: :ordering),
        label: Resources::Material.human_attribute_name(:unit_for_order),
        select_options: { include_blank: t('helpers.prompt.select') }
    ) %>
  </div>
</div>

<div class="row">
  <div class="col-md-6">
    <div class="form-group mb-4">
      <label class="form-label h5 text-muted mb-2">
        <%= Resources::Material.human_attribute_name(:production_unit) %>
        <small class="text-muted">原材料の管理単位</small>
      </label>

      <%= f.collection_select :production_unit_id,
          current_user.units.where(category: :manufacturing),
          :id,
          :name,
          { include_blank: t('helpers.prompt.select') },
          { class: 'form-select form-select-lg' } %>
    </div>
  </div>
  <div class="col-md-6">
    <%= form_group_lg(f, :order_group_id,
        field_type: :collection_select,
        collection: Resources::MaterialOrderGroup.ordered_by_name
    ) %>
  </div>
</div>

<div class="row">
  <div class="col-md-12">
    <%= form_group_lg(f, :description,
        field_type: :text_area,
        rows: 5,
        character_counter: true,
        max_length: 1000
    ) %>
  </div>
</div>
