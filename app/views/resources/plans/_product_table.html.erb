<%#
  機能: 製造計画商品一覧テーブル（読み取り専用）
  - 商品名、数量、売価、小計を表示
  - 詳細画面のタブコンテンツで使用

  必須引数:
  - plan_products: Array<PlanProduct> - 表示対象の商品配列
%>
<% plan_products = local_assigns[:plan_products] %>

<% if plan_products.present? %>
  <table class="table table-sm table-borderless">
    <thead>
      <tr class="border-bottom">
        <th class="text-muted"><%= t('plans.table_headers.product_name') %></th>
        <th class="text-end text-muted"><%= t('plans.table_headers.quantity') %></th>
        <th class="text-end text-muted"><%= t('plans.table_headers.price') %></th>
        <th class="text-end text-muted"><%= t('plans.table_headers.subtotal') %></th>
      </tr>
    </thead>
    <tbody>
      <% (plan_products || []).each_with_index do |pp, index| %>
        <tr class="<%= 'border-bottom' unless index == plan_products.size - 1 %>">
          <td><%= pp.product&.name %></td>
          <td class="text-end"><%= pp.production_count %></td>
          <td class="text-end"><%= format_currency(pp.product&.price) %></td>
          <td class="text-end">
            <% subtotal = pp.production_count * (pp.product&.price || 0) %>
            <%= format_currency(subtotal) %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
<% else %>
  <p class="text-muted text-center" style="padding-top: 50px; font-size: 1.0em;">
    <%= t('plans.messages.no_products_set') %>
  </p>
<% end %>
