<%# リソース詳細アクションボタン %>
<% resource = local_assigns[:resource] %>
<% additional_actions = local_assigns.fetch(:additional_actions, []) %>
<% scope = local_assigns[:scope] %>
<% show_edit_button = local_assigns.fetch(:show_edit_button, true) %>
<% show_delete_button = local_assigns.fetch(:show_delete_button, true) %>

<div class="d-flex gap-2">
  <%# 戻るボタン: scopeがあれば scope_resource_class_path、なければ resource_class_path %>
  <% 
    if scope.present?
      back_path_method = "#{Array(scope).join('_')}_#{resource.class.model_name.route_key}_path".to_sym
    else
      back_path_method = "#{resource.class.model_name.route_key}_path".to_sym
    end
  %>
  <%= link_to scoped_path(back_path_method), 
      class: 'btn btn-light btn-sm', 
      title: t('helpers.link.back') do %>
    <i class="bi bi-arrow-left"></i>
  <% end %>

  <% if show_edit_button %>
    <%# 編集ボタン: scopeがあれば edit_scope_resource_path、なければ edit_resource_path %>
    <% 
      if scope.present?
        edit_path_method = "edit_#{Array(scope).join('_')}_#{resource.class.model_name.route_key.singularize}_path".to_sym
      else
        edit_path_method = "edit_#{resource.class.model_name.route_key.singularize}_path".to_sym
      end
    %>
    <%= link_to scoped_path(edit_path_method, resource), 
        class: 'btn btn-light btn-sm', 
        title: t('helpers.link.edit') do %>
      <i class="bi bi-pencil"></i>
    <% end %>
  <% end %>

  <% additional_actions.each do |action| %>
    <%= link_to action[:path],
                class: "btn btn-sm #{action[:class] || 'btn-light'}",
                target: action[:target],
                title: action[:label] do %>
      <% if action[:icon].present? %>
        <i class="bi <%= action[:icon] %>"></i>
      <% else %>
        <%= action[:label] %>
      <% end %>
    <% end %>
  <% end %>

  <% if show_delete_button %>
    <%# 削除ボタン: scopeがあれば scope_resource_path、なければ resource_path %>
    <% 
      if scope.present?
        delete_path_method = "#{Array(scope).join('_')}_#{resource.class.model_name.route_key.singularize}_path".to_sym
      else
        delete_path_method = "#{resource.class.model_name.route_key.singularize}_path".to_sym
      end
    %>
    <%= button_to scoped_path(delete_path_method, resource), 
        method: :delete,
        data: { turbo_confirm: t('helpers.confirm.destroy', resource: resource.class.model_name.human) },
        class: 'btn btn-danger btn-sm',
        title: t('helpers.link.destroy') do %>
      <i class="bi bi-trash"></i>
    <% end %>
  <% end %>
</div>
